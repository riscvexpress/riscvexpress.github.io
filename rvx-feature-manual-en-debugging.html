<!DOCTYPE html>

<html lang="" xml:lang="" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<meta content="Kyuseung Han ETRI, Daejeon, South Korea" name="author"/>
<title>RVX Manual: Debugging Methods on FPGA Prototypes</title>
<style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">RVX Manual: Debugging Methods on FPGA Prototypes</h1>
<p class="author">Kyuseung Han<br/>
ETRI, Daejeon, South Korea</p>
<p class="date">v2025-07-10 or later</p>
</header>
<h1 id="overview">Overview</h1>
<ul>
<li><p>This manual introduces methods for debugging an SoC built with
RVX on FPGA prototypes.</p></li>
</ul>
<h1 id="prerequisite">Prerequisite</h1>
<ul>
<li><p><a href="rvx-tutorials-hello.html">Tutorial: Hello</a></p></li>
<li><p>An FPGA board connected to your computer - <a href="rvx-fpga-manual-en.html">Manual</a></p></li>
</ul>
<h1 id="things-to-know">Things to Know</h1>
<ul>
<li><p>Any part starting with <span style="background-color: lightgray">#</span> should be replaced or
modified according to your environment.</p></li>
<li><p>On Linux, use the <span style="background-color: lightgray">bash</span> shell for command-line
operations.</p></li>
<li><p>On Windows, use the <span style="background-color: lightgray">Windows Power Shell</span> for
command-line operations.</p></li>
</ul>
<h1 id="software-based-debugging">Software-based Debugging</h1>
<ul>
<li><p>Variables can be printed using <span style="background-color: lightgray">printf</span> for debugging
purposes.</p></li>
<li><p>Include the header file <span style="background-color: lightgray">ervp_printf.h</span> to use this
functionality.</p></li>
<li><p>Several debugging functions, which are extensions of <span style="background-color: lightgray">printf</span>, are available as
listed below:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Function Name</th>
<th style="text-align: center;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">debug_printx(var)</td>
<td style="text-align: center;">Prints <span style="background-color: lightgray">var</span> in <span style="background-color: lightgray">%08x</span> format.</td>
</tr>
<tr>
<td style="text-align: center;">debug_printd(var)</td>
<td style="text-align: center;">Prints <span style="background-color: lightgray">var</span> in <span style="background-color: lightgray">%d</span> format.</td>
</tr>
<tr>
<td style="text-align: center;">debug_printf(var)</td>
<td style="text-align: center;">Prints <span style="background-color: lightgray">var</span> in <span style="background-color: lightgray">%f</span> format.</td>
</tr>
<tr>
<td style="text-align: center;">debug_printc(var)</td>
<td style="text-align: center;">Prints <span style="background-color: lightgray">var</span> in <span style="background-color: lightgray">%c</span> format.</td>
</tr>
<tr>
<td style="text-align: center;">debug_prints(var)</td>
<td style="text-align: center;">Prints <span style="background-color: lightgray">var</span> in <span style="background-color: lightgray">%s</span> format.</td>
</tr>
<tr>
<td style="text-align: center;">debug_printn()</td>
<td style="text-align: center;">Prints a blank line.</td>
</tr>
<tr>
<td style="text-align: center;">debug_print_line()</td>
<td style="text-align: center;">Prints only the current code
location.</td>
</tr>
</tbody>
</table></li>
</ul>
<h1 id="cpu-debugger-based-debugging-not-supported">CPU Debugger-based
Debugging (NOT supported)</h1>
<ul>
<li><p>If a RISC-V CPU includes JTAG functionality (via the RISC-V Debug
Module), users can use OpenOCD or GDB for debugging.</p></li>
<li><p>None of the CPUs provided by RVX include this
functionality.</p></li>
<li><p>If users want to use this feature, they must obtain a CPU that
supports it.</p></li>
</ul>
<h1 id="noc-debugger-based-debugging">NoC Debugger-based Debugging</h1>
<p>This method can only read values based on the memory address.</p>
<h1 id="vivado-ila-based-debugging">Vivado ILA-based Debugging</h1>
<h2 id="overview-1">- Overview</h2>
<ul>
<li><p>This method requires some understanding of Vivado ILA to
use.</p></li>
<li><p>The ILA is a technique that allows you to monitor specific
signals defined during design time for debugging purposes.</p></li>
<li><p>While it enables observation of many signals, the ILA module
becomes part of the design itself, which limits both the number of
signals and the time span that can be captured.</p></li>
<li><p>RVX provides a feature that automatically generates and
integrates an ILA into the design once the debugging signals are
specified.</p></li>
</ul>
<h2 id="location-of-an-example-platform">- Location of an Example
Platform</h2>
<ul>
<li><p><span style="background-color: lightgray">#(cloned
directory)/rvx_platform_example/test_ila</span></p></li>
<li><p>This directory will hereafter be referred to as <span style="background-color: lightgray">#(example dir)</span>.</p></li>
</ul>
<h2 id="defining-debugging-signals">- Defining Debugging Signals</h2>
<ul>
<li><p>Run <span style="background-color: lightgray">make user</span> in
<span style="background-color: lightgray">#(platform dir)</span> if
<span style="background-color: lightgray">#(platform dir)/user</span>
does not exist.</p></li>
<li><p>Define the signals in <span style="background-color: lightgray">#(platform
dir)/user/ila/common</span>.</p>
<ul>
<li><p>Or, <span style="background-color: lightgray">#(platform
dir)/user/ila/#(fpga name)</span>.</p></li>
<li><p>All XML files in these directories will be converted into ILA
modules.</p></li>
<li><p>The names of the XML files can be chosen based on
readability.</p></li>
</ul></li>
<li><p>An example is provided in <span style="background-color: lightgray">#(example
dir)/user/ila/common/core.xml</span>.</p></li>
<li><p>The <span style="background-color: lightgray">&lt;clock&gt;</span> tag sets the
clock signal used for sampling.</p></li>
<li><p>The <span style="background-color: lightgray">&lt;signal&gt;</span> block defines
a signal to be monitored.</p>
<ul>
<li><p><span style="background-color: lightgray">&lt;name&gt;</span>
specifies the display name shown in the ILA GUI,</p></li>
<li><p><span style="background-color: lightgray">&lt;value&gt;</span>
defines the actual signal to be monitored, and</p></li>
<li><p><span style="background-color: lightgray">&lt;width&gt;</span>
indicates its bit width.</p></li>
</ul></li>
<li><p>The signal paths for <span style="background-color: lightgray">&lt;clock&gt;</span> and <span style="background-color: lightgray">&lt;value&gt;</span> should be
specified based on <span style="background-color: lightgray">#(platform
name).v</span>.</p>
<ul>
<li><p>It can be specified using a hierarchical path even if it is not
declared as a port.</p></li>
<li><p>For reference, the file <span style="background-color: lightgray">ila_description.vh</span> is
generated from the XML file, which is a part of <span style="background-color: lightgray">#(platform name).v</span>.</p></li>
</ul></li>
</ul>
<h2 id="generating-ilas-from-xml-files">- Generating ILAs from XML
Files</h2>
<div style="background-color: #1e1e1e; color: #d4d4d4; font-family: 'Courier New', Courier, monospace; padding: 0.5em 0.75em; border-radius: 6px; margin: 1em 0; font-size: 1em; line-height: 1.4;"><pre style="margin: 0; white-space: pre-wrap;"><code>cmd) cd #(fpga dir)
cmd) make ila</code></pre></div>
<h2 id="generating-an-fpga-bitstream-including-ilas">- Generating an
FPGA Bitstream Including ILAs</h2>
<p>Assume that you already have the platform for debugging.</p>
<div style="background-color: #1e1e1e; color: #d4d4d4; font-family: 'Courier New', Courier, monospace; padding: 0.5em 0.75em; border-radius: 6px; margin: 1em 0; font-size: 1em; line-height: 1.4;"><pre style="margin: 0; white-space: pre-wrap;"><code>cmd) cd #(fpga dir)
inst) change IMP_MODE from ‘release’ to ‘debug’ in ‘#(fpga dir)/set_design.tcl’
cmd) make imp</code></pre></div>
<h2 id="debugging-applications-on-fpga-prototypes">- Debugging
Applications on FPGA Prototypes</h2>
<div style="background-color: #1e1e1e; color: #d4d4d4; font-family: 'Courier New', Courier, monospace; padding: 0.5em 0.75em; border-radius: 6px; margin: 1em 0; font-size: 1em; line-height: 1.4;"><pre style="margin: 0; white-space: pre-wrap;"><code>cmd) make program // The Vivado GUI will be launched
inst) Set the trigger conditions of ILAs in the GUI
inst) Open another terminal in the same directory.
cmd) make printf
cmd) make #(app name).all</code></pre></div>
<h1 id="navigate">Navigate</h1>
<ul>
<li><p><a href="index.html">Home</a></p></li>
<li><p><a href="rvx-feature-manual-en.html">Feature Manual
List</a></p></li>
</ul>
</body>
</html>
